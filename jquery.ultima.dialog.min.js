// MIT, Copyright (c) 2014-2022 Alexander Kwaschny, kwaschny.net
!function(){"use strict";if(!window.UltimaDialog){if(void 0===jQuery)throw new Error("jQuery missing for UltimaDialog");if(!jQuery.isPlainObject)throw new Error("jQuery 1.4+ required for UltimaDialog");window.UltimaDialog=function(t){if(!(this instanceof UltimaDialog))return new UltimaDialog(t);this._={};var m=this,h=jQuery(window),p=jQuery("body");if(0===h.length||0===p.length)throw new Error("HTML document malformed");this.curtain=null,this.window=null,this.options={},this.options.current={},this.options.default={animations:{curtain:{show:{effect:"fadeIn",duration:400},hide:{effect:void 0,duration:void 0},deferProgression:!1},window:{show:{effect:"fadeIn",duration:400},hide:{effect:void 0,duration:void 0},deferProgression:!1,reposition:{duration:100},resize:{duration:200,rate:200}}},behavior:{ajax:{cache:!1},closeOnCurtain:!0,closeOnEscape:!0,closeOnWindow:!0,disableScrolling:"auto",preventOverflow:!0,trackSubmit:!0,translateMedia:!0,zIndexInc:!0},css:{loading:{className:"",content:void 0,x:"50%",y:"50%"},curtain:{applyFilter:void 0,className:"",isVisible:!0,zIndex:9003},window:{className:"",close:{className:""},hardMarginX:0,hardMarginY:0,x:"50%",y:"50%",zIndex:9004}},callbacks:{onOpening:void 0,onCurtainOpened:void 0,onWindowOpened:void 0,onContentReady:void 0,onContentVisible:void 0,onAsyncSuccess:void 0,onAsyncError:void 0,onSubmit:void 0,onClosing:void 0,onCurtainClosed:void 0,onWindowClosed:void 0}},this._.properties={classNames:{curtain:"UltimaDialog-curtain",window:{frame:"UltimaDialog-window",content:"UltimaDialog-window-content",close:"UltimaDialog-window-close"}},simulateBorderBox:void 0===window.atob,simulateTransparentBackground:void 0===window.atob,supportsFilter:void 0!==window.atob,supportsMedia:void 0!==window.atob},this.show=function(t){return(!jQuery.isFunction(this.options.current.callbacks.onOpening)||!1!==this.options.current.callbacks.onOpening(m))&&(this.curtain=m._.methods.createCurtain(),this.window=m._.methods.createWindow(t),this.curtain._.properties.window=this.window,this.window._.properties.curtain=this.curtain,!0===this.options.current.behavior.disableScrolling&&UltimaDialog._.methods.disableScrolling(p),p.append(this.curtain.dom.element).append(this.window.dom.element),this.window.relocate(),!0===this.options.current.animations.curtain.deferProgression?this.curtain.show(function(){jQuery.isFunction(m.options.current.callbacks.onCurtainOpened)&&m.options.current.callbacks.onCurtainOpened(m),m.window.show(m.window._.properties.isAjax),m.window.dom.loading&&m.window.dom.loading.css(m.window._.methods.calcInnerPosition(m.window.dom.loading))}):(this.curtain.show(function(){jQuery.isFunction(m.options.current.callbacks.onCurtainOpened)&&m.options.current.callbacks.onCurtainOpened(m)}),this.window.show(m.window._.properties.isAjax),this.window.dom.loading&&this.window.dom.loading.css(this.window._.methods.calcInnerPosition(this.window.dom.loading))),!0)},this.image=function(t,i){return this.show({media:"image",resource:t,attributes:i}),!0},this.video=function(t,i){return this.show({media:"video",resource:t,attributes:i}),!0},this.audio=function(t,i){return this.show({media:"audio",resource:t,attributes:i}),!0},jQuery.each(["get","post","put","delete"],function(t,e){m[e]=function(t,i,o){return this.show({method:e.toUpperCase(),url:t,data:i,settings:o}),!0}}),this.iframe=function(t,i){return this.show({media:"iframe",resource:t,attributes:i}),!0},this.close=function(t,i){return jQuery.isFunction(t)||(i=t,t=void 0),UltimaDialog._.methods.enableScrolling(p),null!==this.window&&(this.window.close(t,i),!0)},this._.methods={createCurtain:function(){var t={dom:{element:jQuery("<div></div>").hide()},close:function(t,i){var o=this;return"number"==typeof t&&(i=t,t=void 0),this._.methods.filterOff(),m.options.current.animations.curtain.hide.effect,this.dom.element.stop(!0,!0).fadeOut(void 0===i?m.options.current.animations.curtain.hide.duration:i,function(){o.dom.element.remove(),jQuery.isFunction(t)&&t(m),jQuery.isFunction(m.options.current.callbacks.onCurtainClosed)&&m.options.current.callbacks.onCurtainClosed(m)}),!0},show:function(t){var i=this;return m.options.current.animations.curtain.show.effect,this.dom.element.fadeIn(m.options.current.animations.curtain.show.duration,function(){i.isOpened=!0,jQuery.isFunction(t)&&t(m)}),!0},_:{properties:{isOpened:!1,window:void 0},methods:{filterOn:function(){if(!1===m._.properties.supportsFilter)return!1;var e=m.options.current.css.curtain.applyFilter;if("string"!=typeof e)return!1;var t=p.children(":not(script, style)");return jQuery.each(t,function(t,i){var o=jQuery(i);o.hasClass(m._.properties.classNames.curtain)||o.hasClass(m._.properties.classNames.window)||o.css({"-webkit-filter":e,filter:e})}),!0},filterOff:function(){if(!1===m._.properties.supportsFilter)return!1;if("string"!=typeof m.options.current.css.curtain.applyFilter)return!1;var t=p.children(":not(script, style)");return jQuery.each(t,function(t,i){var o=jQuery(i);o.hasClass(m._.properties.classNames.curtain)||o.hasClass(m._.properties.classNames.window)||o.css({"-webkit-filter":"",filter:""})}),!0}}}};t.dom.element.addClass(m._.properties.classNames.curtain),t.dom.element.addClass(m.options.current.css.curtain.className);var i={};return m.options.current.css.curtain.className||(i.backgroundColor="#000000",i.opacity=.67),jQuery.extend(!0,i,m.options.current.css.curtain),jQuery.extend(!0,i,{bottom:0,height:"100%",left:0,position:"fixed",right:0,top:0,width:"100%",zIndex:m.options.current.css.curtain.zIndex+(m.options.current.behavior.zIndexInc?UltimaDialog.collection.length:0)}),!1===m.options.current.css.curtain.isVisible&&(i.background=m._.properties.simulateTransparentBackground?"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)":"transparent"),t.dom.element.css(i),t._.methods.filterOn(),t.dom.element.click(function(){!0===m.options.current.behavior.closeOnCurtain&&t.isOpened&&(!1!==m.options.current.behavior.disableScrolling&&UltimaDialog._.methods.enableScrolling(p),t._.properties.window.close())}),t},createWindow:function(t,i){var c={dom:{element:jQuery("<div></div>").hide(),content:jQuery("<div></div>").css("opacity",0),loading:void 0,closeButton:void 0},_:{properties:{curtain:void 0,isAjax:!1,url:void 0},methods:{attachSubmitTracking:function(){return!i&&(c.dom.content.find("form").submit(function(t){return t.preventDefault(),UltimaDialog._.methods.submit(this)}),!0)},calcPosition:function(t,i){var o={};return void 0===t&&(t=c.dom.element.outerWidth()),void 0===i&&(i=c.dom.element.outerHeight()),/^[0-9]{1,3}%$/.test(m.options.current.css.window.x)?o.left=m.options.current.css.window.x.replace("%","")*h.width()/100-t/2:o.left=m.options.current.css.window.x,o.left<0&&(o.left=0),/^[0-9]{1,3}%$/.test(m.options.current.css.window.y)?o.top=m.options.current.css.window.y.replace("%","")*h.height()/100-i/2:o.top=m.options.current.css.window.y,o.top<0&&(o.top=0),o},calcInnerPosition:function(t){var i,o,e,n={};return/^[0-9]{1,3}%$/.test(m.options.current.css.loading.x)?n.marginLeft=m.options.current.css.loading.x.replace("%","")*c.dom.content.width()/100-t.width()/2:n.marginLeft=m.options.current.css.loading.x,n.marginLeft<0&&(n.marginLeft=0),/^[0-9]{1,3}%$/.test(m.options.current.css.loading.y)?(i=0,i+=(o=c._.methods.getPadding(c.dom.element)).bottom+o.top,i+=(e=c._.methods.getPadding(c.dom.content)).bottom+e.top,n.marginTop=m.options.current.css.loading.y.replace("%","")*(c.dom.element.innerHeight()-i)/100-t.height()/2):n.marginTop=m.options.current.css.loading.y,n.marginTop<0&&(n.marginTop=0),n},calcSize:function(t){var i=m._.methods.createWindow(t,!0).dom.element;i.css({display:"none",left:0,top:0}),p.append(i);var o,e={width:i.outerWidth(),height:i.outerHeight()};m._.properties.simulateBorderBox&&(o=c._.methods.getPadding(i),e.width-=o.left+o.right,e.height-=o.bottom+o.top),i.remove();var n=h.width();n-=m.options.current.css.window.hardMarginX;var r=h.height();return r-=m.options.current.css.window.hardMarginY,e.width>n&&(e.width=n),e.height>r&&(e.height=r),e},getPadding:function(t){var i={bottom:parseInt(t.css("padding-bottom"),10),left:parseInt(t.css("padding-left"),10),right:parseInt(t.css("padding-right"),10),top:parseInt(t.css("padding-top"),10)};return i={bottom:isNaN(i.bottom)?0:i.bottom,left:isNaN(i.left)?0:i.left,right:isNaN(i.right)?0:i.right,top:isNaN(i.top)?0:i.top}},rememberSize:function(t){var i,o={width:t.outerWidth(),height:t.outerHeight()};return m._.properties.simulateBorderBox&&(i=c._.methods.getPadding(t),o.width-=i.left+i.right,o.height-=i.bottom+i.top),t.css({"min-height":o.height,"min-width":o.width}),!0},setLoading:function(){var t,i;(m.options.current.css.loading.content||m.options.current.css.loading.className)&&((t=jQuery("<div></div>")).addClass(m.options.current.css.loading.className),i={},jQuery.extend(i,m.options.current.css.loading),delete i.content,t.css(i),"string"==typeof m.options.current.css.loading.content?t.html(m.options.current.css.loading.content):m.options.current.css.loading.content instanceof jQuery&&t.append(jQuery(m.options.current.css.loading.content).clone(!0).show()),c.dom.loading=t,c.dom.content.append(t),c.dom.content.fadeTo(m.options.current.animations.window.resize.duration,1))}}},close:function(t,i){var o=this;if(jQuery.isFunction(m.options.current.callbacks.onClosing)&&!1===m.options.current.callbacks.onClosing(m))return!1;for(var e=0;e<UltimaDialog.collection.length;e++)this===UltimaDialog.collection[e].window&&UltimaDialog.collection.splice(e,1);return m.options.current.animations.window.hide.effect,!0!==m.options.current.animations.window.deferProgression&&this._.properties.curtain.close(void 0===i?void 0:0),this.dom.element.stop(!0,!0).fadeOut(void 0===i?m.options.current.animations.window.hide.duration:0,function(){o.dom.element.remove(),jQuery.isFunction(t)&&t(m),jQuery.isFunction(m.options.current.callbacks.onWindowClosed)&&m.options.current.callbacks.onWindowClosed(m),!0===m.options.current.animations.window.deferProgression&&o._.properties.curtain.close(void 0===i?void 0:0)}),!0},reposition:function(t,i,o){void 0===t?t=0:jQuery.isFunction(t)?t=(jQuery.isFunction(i)?(o=i,i=t):o=t,0):jQuery.isFunction(o)||(o=i,i=void 0);var e=this._.methods.calcPosition();if(0<t){if(jQuery.isFunction(i)&&!1===i(this))return!1;this.dom.element.animate(e,t,o)}else{if(jQuery.isFunction(i)&&!1===i(this))return!1;this.dom.element.css(e),jQuery.isFunction(o)&&o(this)}return!0},resetContent:function(t,i){return c.dom.content.fadeTo(m.options.current.animations.window.resize.duration,0,function(){void 0!==i?c.dom.content.children(i).remove():c.dom.content.html(""),jQuery.isFunction(t)&&t(m)}),!0},resize:function(t){if(!0!==m.options.current.behavior.preventOverflow)return!1;var i=void 0!==m.options.current.css.window.width||void 0!==m.options.current.css.window.height,o=m.options.current.css.window.width;/^[0-9]{1,3}%$/.test(o)&&(o=o.replace("%","")*h.width()/100),isNaN(parseFloat(o))&&(o=this.dom.element.outerWidth());var e=m.options.current.css.window.height;/^[0-9]{1,3}%$/.test(e)&&(e=e.replace("%","")*h.height()/100),isNaN(parseFloat(e))&&(e=this.dom.element.outerHeight());var n=this._.methods.getPadding(this.dom.element),r=n.left+n.right,s=n.bottom+n.top,a=m.options.current.css.window.hardMarginX,c=m.options.current.css.window.hardMarginY,d=!1,l=h.width()-r-a;l<=o?(d=!0,o=l,this.dom.element.css({minWidth:""}),this.dom.content.css({overflow:"auto",maxWidth:o})):(this.dom.content.css("max-width",""),i?this.dom.content.css("width",o-r-a):this.dom.content.css("width",""));var u=h.height()-s-c;return u<=e?(d=!0,e=u,this.dom.element.css({minHeight:""}),this.dom.content.css({overflow:"auto",maxHeight:e})):(this.dom.content.css("max-height",""),i?this.dom.content.css("height",e-s-c):this.dom.content.css("height","")),this.dom.content.css("overflow",i||d?"auto":""),"auto"===m.options.current.behavior.disableScrolling&&(t||i||d?(UltimaDialog._.methods.disableScrolling(p),this.dom.content.css({maxWidth:h.width()-r-a,maxHeight:h.height()-s-c})):UltimaDialog._.methods.enableScrolling(p)),!0},relocate:function(t){var i=0;return!0===t&&(i=m.options.current.animations.window.reposition.duration),this.resize(),this.reposition(i),!0},setContent:function(e,t){if(!e)return c.resetContent(),!1;if(c._.properties.isAjax=!1,c._.properties.url=location.href,/^(GET|POST|PUT|DELETE)$/i.test(e.method)){c._.properties.isAjax=!0,c._.methods.setLoading();var i=jQuery.extend(!0,e.settings,{type:e.method,url:e.url,data:e.data,cache:m.options.current.behavior.ajax.cache,success:function(t){if(jQuery.isFunction(m.options.current.callbacks.onAsyncSuccess)&&!1===m.options.current.callbacks.onAsyncSuccess(m,t))return!1;c._.methods.rememberSize(c.dom.element);var i=c._.methods.calcSize(t),o=c._.methods.calcPosition(i.width,i.height);c.resetContent(function(){c.dom.loading=void 0,c.dom.element.animate({"min-height":i.height,left:o.left,top:o.top,"min-width":i.width},m.options.current.animations.window.resize.duration,function(){jQuery.isFunction(m.options.current.callbacks.onContentReady)&&!1===m.options.current.callbacks.onContentReady(m,t)||(c.dom.content.html(t),c.dom.content.find("[data-ultimadialog-id]").each(function(){var t=jQuery(this),i=t.attr("data-ultimadialog-id"),o=i+Math.floor(1e4*Math.random());t.attr("id",o).removeAttr("data-ultimadialog-id"),c.dom.content.find('[data-ultimadialog-for="'+i+'"]').attr("for",o).removeAttr("data-ultimadialog-for")}),!0===m.options.current.behavior.trackSubmit&&c._.methods.attachSubmitTracking(),c.relocate(),c.dom.content.find("img").on("load",function(){c.relocate()}),c.dom.content.fadeTo(m.options.current.animations.window.show.duration,1,function(){jQuery.isFunction(m.options.current.callbacks.onContentVisible)&&m.options.current.callbacks.onContentVisible(m)}))})})},error:function(t){var i=t.status+": "+t.statusText;jQuery.isFunction(m.options.current.callbacks.onAsyncError)&&m.options.current.callbacks.onAsyncError(m,t),c._.methods.rememberSize(c.dom.element);var o=c._.methods.calcSize(i),e=c._.methods.calcPosition(o.width,o.height);c.resetContent(function(){c.dom.loading=void 0,c.dom.element.animate({"min-height":o.height,left:e.left,top:e.top,"min-width":o.width},m.options.current.animations.window.resize.duration,function(){jQuery.isFunction(m.options.current.callbacks.onContentReady)&&!1===m.options.current.callbacks.onContentReady(m,i)||(c.dom.content.html(i),c.relocate(),c.dom.content.fadeTo(m.options.current.animations.window.show.duration,1,function(){jQuery.isFunction(m.options.current.callbacks.onContentVisible)&&m.options.current.callbacks.onContentVisible(m)}))})})}});c._.properties.url=i.url,"GET"===e.method?c.query=i.data:c.query="",jQuery.ajax(i)}else if("iframe"===e.media){var n=jQuery("<iframe>").css({height:0,opacity:0,width:0});e.attributes||(e.attributes={}),"number"!=typeof e.attributes.width&&(e.attributes.width=640),"number"!=typeof e.attributes.height&&(e.attributes.height=360),n.attr(e.attributes),n.attr("src",e.resource),c.dom.content.html(n),n.on("load",function(){if(n.unbind("load"),jQuery.isFunction(m.options.current.callbacks.onAsyncSuccess)&&!1===m.options.current.callbacks.onAsyncSuccess(m,e.resource))return!1;c._.methods.rememberSize(c.dom.element);var t=c._.methods.getPadding(c.dom.element),i={width:(isNaN(parseInt(n.attr("width"),10))?0:parseInt(n.attr("width"),10))+(m._.properties.simulateBorderBox?0:t.left+t.right),height:(isNaN(parseInt(n.attr("height"),10))?0:parseInt(n.attr("height"),10))+(m._.properties.simulateBorderBox?0:t.bottom+t.top)},o=c._.methods.calcPosition(i.width,i.height);c.resetContent(function(){c.dom.loading=void 0,c.dom.element.animate({"min-height":i.height,left:o.left,top:o.top,"min-width":i.width},m.options.current.animations.window.resize.duration,function(){n.css({height:"",opacity:1,width:""}),jQuery.isFunction(m.options.current.callbacks.onContentReady)&&!1===m.options.current.callbacks.onContentReady(m,n)||(c.relocate(),c.dom.content.fadeTo(m.options.current.animations.window.show.duration,1,function(){jQuery.isFunction(m.options.current.callbacks.onContentVisible)&&m.options.current.callbacks.onContentVisible(m)}))})},":not(iframe)")}),c._.methods.setLoading()}else if("image"===e.media){var o=jQuery("<img>");o.on("load",function(){if(jQuery.isFunction(m.options.current.callbacks.onAsyncSuccess)&&!1===m.options.current.callbacks.onAsyncSuccess(m,e.resource))return!1;c._.methods.rememberSize(c.dom.element);var t=c._.methods.calcSize(o),i=c._.methods.calcPosition(t.width,t.height);c.resetContent(function(){c.dom.loading=void 0,c.dom.element.animate({"min-height":t.height,left:i.left,top:i.top,"min-width":t.width},m.options.current.animations.window.resize.duration,function(){jQuery.isFunction(m.options.current.callbacks.onContentReady)&&!1===m.options.current.callbacks.onContentReady(m,o)||(c.dom.content.html(o),c.relocate(),c.dom.content.fadeTo(m.options.current.animations.window.show.duration,1,function(){jQuery.isFunction(m.options.current.callbacks.onContentVisible)&&m.options.current.callbacks.onContentVisible(m)}))})})}),e.attributes||(e.attributes={}),e.attributes.width?(o.css("width",e.attributes.width),delete e.attributes.width):o.css("width","auto"),e.attributes.height?(o.css("height",e.attributes.height),delete e.attributes.height):o.css("height","auto"),o.attr(e.attributes),o.attr("src",e.resource),c._.methods.setLoading()}else if("video"===e.media||"audio"===e.media){var r=jQuery("<"+e.media+">").attr("controls","controls").css({height:0,opacity:0,width:0});jQuery.isArray(e.resource)||(e.resource=[e.resource]),jQuery.each(e.resource,function(t,i){var o=jQuery("<source>").attr("src",i);r.append(o)}),r.append(jQuery("<a>").attr("href",e.resource[0]).text(e.resource[0]));var s={video:{width:640,height:360},audio:{width:320,height:30}};(h[0].ActiveXObject||"ActiveXObject"in h[0])&&(s.audio.width=580,s.audio.height=80),e.attributes||(e.attributes={}),"number"!=typeof e.attributes.width&&(e.attributes.width=s[e.media].width),"number"!=typeof e.attributes.height&&(e.attributes.height=s[e.media].height),r.attr(e.attributes),r.attr("src",e.resource),c.dom.content.html(r);var a=function(){if(jQuery.isFunction(m.options.current.callbacks.onAsyncSuccess)&&!1===m.options.current.callbacks.onAsyncSuccess(m,e.resource))return!1;c._.methods.rememberSize(c.dom.element);var t=c._.methods.getPadding(c.dom.element),i={width:(isNaN(parseInt(r.attr("width"),10))?0:parseInt(r.attr("width"),10))+(t.left+t.right),height:(isNaN(parseInt(r.attr("height"),10))?0:parseInt(r.attr("height"),10))+(t.bottom+t.top)},o=c._.methods.calcPosition(i.width,i.height);c.resetContent(function(){c.dom.loading=void 0,c.dom.element.animate({"min-height":i.height,left:o.left,top:o.top,"min-width":i.width},m.options.current.animations.window.resize.duration,function(){r.css({height:"",opacity:1,width:e.attributes.width}),jQuery.isFunction(m.options.current.callbacks.onContentReady)&&!1===m.options.current.callbacks.onContentReady(m,r)||(c.relocate(),c.dom.content.fadeTo(m.options.current.animations.window.show.duration,1,function(){jQuery.isFunction(m.options.current.callbacks.onContentVisible)&&m.options.current.callbacks.onContentVisible(m)}))})},":not("+e.media+")")};m._.properties.supportsMedia?r[0].onloadstart=a:(jQuery.isFunction(m.options.current.callbacks.onAsyncError)&&m.options.current.callbacks.onAsyncError(m,"Browser does not support the required media tag: "+e.media),setTimeout(a,200)),c._.methods.setLoading()}else if("string"==typeof e){if(!0===m.options.current.behavior.translateMedia){if(/\.(gif|jpe?g|png)(\?|$)/i.test(e))return c.setContent({media:"image",resource:e});if(/\.(mp3)(\?|$)/i.test(e))return c.setContent({media:"audio",resource:e})}if(!1!==t&&jQuery.isFunction(m.options.current.callbacks.onContentReady)&&!1===m.options.current.callbacks.onContentReady(m,e))return!1;c.dom.content.html(e),!0===m.options.current.behavior.trackSubmit&&c._.methods.attachSubmitTracking()}else{if((e=jQuery(e).clone(!0)).removeAttr("id").find("[id]").removeAttr("id"),e.find("[data-ultimadialog-id]").each(function(){var t=jQuery(this),i=t.attr("data-ultimadialog-id"),o=i+Math.floor(1e4*Math.random());t.attr("id",o).removeAttr("data-ultimadialog-id"),e.find('[data-ultimadialog-for="'+i+'"]').attr("for",o).removeAttr("data-ultimadialog-for")}),!1!==t&&jQuery.isFunction(m.options.current.callbacks.onContentReady)&&!1===m.options.current.callbacks.onContentReady(m,e))return!1;c.dom.content.html(e.show()),!0===m.options.current.behavior.trackSubmit&&c._.methods.attachSubmitTracking()}return!0},show:function(t){var i=this;return m.options.current.animations.window.show.effect,!0!==m.options.current.animations.curtain.deferProgression&&this.dom.content.css("opacity",1),this.dom.element.fadeIn(m.options.current.animations.window.show.duration,function(){jQuery.isFunction(m.options.current.callbacks.onWindowOpened)&&m.options.current.callbacks.onWindowOpened(m),!0===m.options.current.animations.curtain.deferProgression?i.dom.content.fadeTo(m.options.current.animations.window.resize.duration,1,function(){!0!==t&&jQuery.isFunction(m.options.current.callbacks.onContentVisible)&&m.options.current.callbacks.onContentVisible(m)}):!0!==t&&jQuery.isFunction(m.options.current.callbacks.onContentVisible)&&m.options.current.callbacks.onContentVisible(m)}),!0}};c.dom.element.addClass(m._.properties.classNames.window.frame),c.dom.element.addClass(m.options.current.css.window.className);var o={};return m.options.current.css.window.className||(o.backgroundColor="#FFFFFF",o.color="#000000"),jQuery.extend(!0,o,m.options.current.css.window),jQuery.extend(!0,o,{boxSizing:"border-box",position:"fixed",zIndex:m.options.current.css.window.zIndex+UltimaDialog.collection.length}),c.dom.element.css(o),c.dom.content.addClass(m._.properties.classNames.window.content),c.dom.element.append(c.dom.content),void 0!==i&&"string"==typeof t&&(t=(t=t.replace(/<script/gi,'<scriptdisabled style="display: none !important;"')).replace(/<\/script/gi,"</scriptdisabled")),c.setContent(t,void 0===i),!0===m.options.current.behavior.closeOnWindow&&(c.dom.closeButton=jQuery("<div></div>"),c.dom.closeButton.addClass(m._.properties.classNames.window.close),c.dom.closeButton.addClass(m.options.current.css.window.close.className),c.dom.closeButton.css(m.options.current.css.window.close),c.dom.closeButton.html(m.options.current.css.window.close.content),c.dom.element.prepend(c.dom.closeButton),c.dom.closeButton.click(function(){m.close()})),!0!==i&&(jQuery(document).unbind("keydown",UltimaDialog._.methods.closeOnEscape),!0===m.options.current.behavior.closeOnEscape&&jQuery(document).bind("keydown",UltimaDialog._.methods.closeOnEscape),h.resize(function(){UltimaDialog._.methods.resizePolling(m.options.current.animations.window.resize.rate)})),!0!==i&&UltimaDialog.collection.push(m),c},mergeOptions:function(t,i){m._.methods.translateOptions(i);var o={};return jQuery.extend(!0,o,t),jQuery.extend(!0,o,i),void 0===o.animations.curtain.hide.effect&&(o.animations.curtain.hide.effect=o.animations.curtain.show.effect),void 0===o.animations.curtain.hide.duration&&(o.animations.curtain.hide.duration=o.animations.curtain.show.duration),void 0===o.animations.window.hide.effect&&(o.animations.window.hide.effect=o.animations.window.show.effect),void 0===o.animations.window.hide.duration&&(o.animations.window.hide.duration=o.animations.window.show.duration),o},translateOptions:function(t){var i,o,e,n,r;for(var s in t)if(t.hasOwnProperty(s)&&0===s.indexOf("->")){for(o=(i=(i=s.replace("->","")).split(".")).length,r=n={},e=0;e<o-1;e++)r[i[e]]={},r=r[i[e]];r[i[o-1]]=t[s],delete t[s],jQuery.extend(!0,t,n)}return t}},this.options.current=this._.methods.mergeOptions(this.options.default,UltimaDialog.options),this.options.current=this._.methods.mergeOptions(this.options.current,t)},UltimaDialog.collection=[],UltimaDialog.options={},UltimaDialog._={properties:{},methods:{}},UltimaDialog._.properties.resizePollingTimer=null,UltimaDialog._.methods.closeByIndex=function(t,i,o){"boolean"==typeof i&&(o=i,i=void 0);var e=UltimaDialog.collection[t];return!!e&&("number"!=typeof i&&(i=-1),e.close(function(){UltimaDialog._.methods.closeByIndex(t+i,o)},o),!0)},UltimaDialog._.methods.closeOnEscape=function(t){27===t.which&&UltimaDialog.close(!1)},UltimaDialog._.methods.disableScrolling=function(t){return t.css({overflow:"hidden","-webkit-backface-visibility":"hidden"}),!0},UltimaDialog._.methods.enableScrolling=function(t){return t.css({overflow:"","-webkit-backface-visibility":""}),!0},UltimaDialog._.methods.isOptions=function(t){if(!jQuery.isPlainObject(t))return!1;if(t.animations&&jQuery.isPlainObject(t.animations)||t.behavior&&jQuery.isPlainObject(t.behavior)||t.css&&jQuery.isPlainObject(t.css)||t.callbacks&&jQuery.isPlainObject(t.callbacks))return!0;for(var i in t)if(t.hasOwnProperty(i)&&/^->[a-z]+(\.[a-z]+)?/.test(i))return!0;return!1},UltimaDialog._.methods.resizePolling=function(t){clearTimeout(UltimaDialog._.properties.resizePollingTimer),UltimaDialog._.properties.resizePollingTimer=setTimeout(UltimaDialog.relocate,t)},UltimaDialog._.methods.submit=function(t,i){var o=jQuery(t);if(!o.is("form"))return!1;var e=UltimaDialog.collection.length;if(0===e)return!1;var n,r=UltimaDialog.collection[e-1],s=o.attr("action"),a="";"string"==typeof s&&(a=0<=(n=s.lastIndexOf("?"))?s.substring(0,n):s),0===a.length&&(s=r.window._.properties.url,r.window.query&&(jQuery.isPlainObject(r.window.query)?s+="?"+jQuery.param(r.window.query):0<r.window.query.length&&(s+="?"+r.window.query)));var c=o.attr("method");/^(GET|POST|PUT|DELETE)$/i.test(c)||(c="GET");var d=o.serialize();return jQuery.isFunction(r.options.current.callbacks.onSubmit)&&!1===r.options.current.callbacks.onSubmit(r,d)||r.window.resetContent(function(){r.window.setContent({method:c.toUpperCase(),url:s,data:d,settings:i},!1),r.window.dom.loading&&r.window.dom.loading.css(r.window._.methods.calcInnerPosition(r.window.dom.loading))}),!1},UltimaDialog.close=function(t,i){if("boolean"==typeof t&&(i=t,t=void 0),void 0===t&&0<UltimaDialog.collection.length&&(t=UltimaDialog.collection.length-1),"number"!=typeof t||isNaN(t))return!1;var o=UltimaDialog.get(isNaN(parseInt(t))?UltimaDialog.collection.length:parseInt(t));return null!==o&&(o.close(!1===i?0:void 0),!0)},UltimaDialog.closeAll=function(t,i){var o=UltimaDialog.collection.length;if(0<o){if(!0===i)return UltimaDialog._.methods.closeByIndex(o-1,-1,t),!0;for(var e=o-1;0<=e;--e)UltimaDialog.collection[e].close(!1===t?0:void 0);return!0}return!1},UltimaDialog.get=function(t){var i=UltimaDialog.collection.length;return 0===i?null:(void 0===t&&(t=i-1),"string"==typeof t&&(t=parseInt(t,10)),"number"!=typeof t||isNaN(t)||i<=t?null:UltimaDialog.collection[t])},UltimaDialog.isOpened=function(t){return null!==UltimaDialog.get(t)},UltimaDialog.relocate=function(t){var i=UltimaDialog.get(t);return null!==i&&(i.window.relocate(!0),!0)},UltimaDialog.setOptions=function(t,i,o){"number"!=typeof t&&("boolean"==typeof i&&(o=i),i=t,t=void 0);var e=UltimaDialog.get(t);return null!==e&&(e.options.current=!0===o?e._.methods.mergeOptions({},i):e._.methods.mergeOptions(e.options.current,i),!0)},jQuery.UltimaDialog={options:{}},jQuery.UltimaDialog.show=function(t,i){var o={};jQuery.extend(!0,o,jQuery.UltimaDialog.options),jQuery.extend(!0,o,i);var e=new UltimaDialog(o);return e.show(t),e},jQuery.each(["image","video","audio","iframe"],function(t,r){jQuery.UltimaDialog[r]=function(t,i,o){if(void 0===t)return null;2===arguments.length&&UltimaDialog._.methods.isOptions(i)&&(o=i,i=void 0);var e={};jQuery.extend(!0,e,jQuery.UltimaDialog.options),jQuery.extend(!0,e,o);var n=new UltimaDialog(e);return n[r](t,i),n}}),jQuery.each(["get","post","put","delete"],function(t,a){jQuery.UltimaDialog[a]=function(t,i,o,e){if(void 0===t)return null;var n=arguments.length;3===n?jQuery.isFunction(o)||(e=o,o=void 0):2===n&&(jQuery.isFunction(i)?(o=i,i=void 0):UltimaDialog._.methods.isOptions(i)&&(e=i,i=void 0));var r={};jQuery.extend(!0,r,jQuery.UltimaDialog.options),jQuery.extend(!0,r,e),void 0!==o&&(jQuery.isPlainObject(r.callbacks)||(r.callbacks={}),r.callbacks.onAsyncSuccess=o,r.callbacks.onAsyncError=o);var s=new UltimaDialog(r);return s[a](t,i),s}}),jQuery.fn.UltimaDialog=function(t){var i={};return jQuery.extend(!0,i,jQuery.UltimaDialog.options),jQuery.extend(!0,i,t),this.each(function(){new UltimaDialog(i).show(this)}),this},UltimaDialog.version="0.95.6"}}();
